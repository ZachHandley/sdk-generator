from __future__ import annotations

class Query:
    @staticmethod
    def equal(attribute: str, value: str | list[str]) -> str:
        return Query.add_query(attribute, "equal", value)

    @staticmethod
    def not_equal(attribute: str, value: str | list[str]) -> str:
        return Query.add_query(attribute, "notEqual", value)
    
    @staticmethod
    def less_than(attribute: str, value: str | list[str]) -> str:
        return Query.add_query(attribute, "lessThan", value)
    
    @staticmethod
    def less_than_equal(attribute: str, value: str | list[str]) -> str:
        return Query.add_query(attribute, "lessThanEqual", value)
    
    @staticmethod
    def greater_than(attribute: str, value: str | list[str]) -> str:
        return Query.add_query(attribute, "greaterThan", value)
    
    @staticmethod
    def greater_than_equal(attribute: str, value: str | list[str]) -> str:
        return Query.add_query(attribute, "greaterThanEqual", value)

    @staticmethod
    def is_null(attribute: str) -> str:
        return f'isNull("{attribute}")'

    @staticmethod
    def is_not_null(attribute: str) -> str:
        return f'isNotNull("{attribute}")'

    @staticmethod
    def between(attribute: str, start: str | int, end: str | int) -> str:
        return f'between("{attribute}", {Query.parseValues(start)}, {Query.parseValues(end)})'

    @staticmethod
    def starts_with(attribute: str, value: str) -> str:
        return Query.add_query(attribute, "startsWith", value)

    @staticmethod
    def ends_with(attribute: str, value: str) -> str:
        return Query.add_query(attribute, "endsWith", value)

    @staticmethod
    def select(attributes: list[str]) -> str:
        return f'select([{",".join(map(Query.parseValues, attributes))}])'

    @staticmethod
    def search(attribute: str, value: str) -> str:
        return Query.add_query(attribute, "search", value)

    @staticmethod
    def order_asc(attribute: str) -> str:
        return f'orderAsc("{attribute}")'

    @staticmethod
    def order_desc(attribute: str) -> str:
        return f'orderDesc("{attribute}")'

    @staticmethod
    def cursor_before(id: str) -> str:
        return f'cursorBefore("{id}")'

    @staticmethod
    def cursor_after(id: str) -> str:
        return f'cursorAfter("{id}")'

    @staticmethod
    def limit(limit: int) -> str:
        return f'limit({limit})'

    @staticmethod
    def offset(offset: int) -> str:
        return f'offset({offset})'

    @staticmethod
    def add_query(attribute: str, method: str, value: str | list[str]) -> str:
        if isinstance(value, list):
            return f'{method}("{attribute}", [{",".join(map(Query.parseValues, value))}])'
        else:
            return f'{method}("{attribute}", [{Query.parseValues(value)}])'

    @staticmethod
    def parseValues(value: str | int | bool) -> str:
        if isinstance(value, str):
            return f'"{value}"'
        elif isinstance(value, bool):
            return str(value).lower()
        else:
            return str(value)